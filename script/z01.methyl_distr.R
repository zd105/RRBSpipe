################
# 绘制C位点甲基化水平的分布
# 用法：
#     z01.z01.methyl_distr.R infile outfile
# 输入文件格式：
#########################################
#	CG	CHG	CHH
#[0,0.1)	0.120946785	0.138971474	0.650840649
#[0.1,0.2)	0.077062877	0.089175356	0.116816655
#[0.2,0.3)	0.056911997	0.076997818	0.059114109
#[0.3,0.4)	0.045222842	0.072850296	0.037000598
#[0.4,0.5)	0.042275573	0.075972856	0.027260841
#[0.5,0.6)	0.050512477	0.087672859	0.022682883
#[0.6,0.7)	0.064611636	0.089312718	0.017492999
#[0.7,0.8)	0.101704028	0.101019993	0.013923476
#[0.8,0.9)	0.151598535	0.107528524	0.010420904
#[0.9,1]	0.289153251	0.160498107	0.044446884
##########################################


args <- commandArgs(T)
file <- args[1]
outpdf <- args[2]

#####
rt <- read.table(file=file, header=T)
rt <- t(as.matrix(rt)) 
pdf(file=outpdf, height=4, width=6)
par(las=2)  
barplot(rt, beside=T, col=c("royalblue", "firebrick","gold"), ylab="Methylation level", 
  legend=T)  
dev.off()
